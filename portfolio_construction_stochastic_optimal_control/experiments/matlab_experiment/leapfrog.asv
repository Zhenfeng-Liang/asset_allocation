function flows = leapfrog(T, N, xT, pT, mu, sig, gamma)
    flows = zeros(N+1,2);
    flows(N+1,1) = xT;
    flows(N+1,2) = pT;
    
    h = (T/N);

    for i = (N):-1:1
        pHalf = flows(i+1,2) + 0.5*h*hamDx(flows(i+1,1), flows(i+1,2), mu, sig, gamma);
        flows(i,1) = newtonRaphson(0.0001, @hamDp, @hamDxp, flows(i,))
        %flows(i,1) = (1-mu*h/2/gamma)/(1+mu*h/2/gamma) * flows(i+1,1);
        flows(i,2) = pHalf + 0.5*h*hamDx(flows(i,1), pHalf, mu, sig, gamma);
    end
end

